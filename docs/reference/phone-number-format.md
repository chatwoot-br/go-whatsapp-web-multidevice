# Phone Number Format Reference

Complete guide to phone number formatting and JID (Jabber ID) format used by WhatsApp.

## Table of Contents

- [Overview](#overview)
- [JID Format Explained](#jid-format-explained)
- [Individual Phone Numbers](#individual-phone-numbers)
- [Group Identifiers](#group-identifiers)
- [Newsletter Identifiers](#newsletter-identifiers)
- [Format Examples by Country](#format-examples-by-country)
- [Common Mistakes](#common-mistakes)
- [Validation Rules](#validation-rules)
- [API Usage](#api-usage)
- [Troubleshooting](#troubleshooting)

## Overview

WhatsApp uses a special identifier format called JID (Jabber ID) to identify users, groups, and newsletters in their system. Understanding this format is crucial for successful API interactions.

**Key Concepts:**

- **JID (Jabber ID)**: WhatsApp's internal identifier format
- **Phone Number**: Your regular phone number with country code
- **Suffix**: Additional identifier that determines the type (user, group, newsletter)

**Format Pattern:**
```
[identifier]@[suffix]
```

## JID Format Explained

### What is JID?

JID stands for Jabber ID, which WhatsApp inherited from the XMPP (Extensible Messaging and Presence Protocol) standard. It's the universal identifier format used throughout the WhatsApp ecosystem.

### JID Components

```
5511999998888@s.whatsapp.net
│            │ │              │
│            │ │              └─ Domain (always whatsapp.net)
│            │ └─ Server type identifier
│            └─ @ separator
└─ Identifier (country code + phone number)
```

### JID Types

| Type | Suffix | Example | Description |
|------|--------|---------|-------------|
| Individual | `@s.whatsapp.net` | `5511999998888@s.whatsapp.net` | Personal WhatsApp account |
| Group | `@g.us` | `120363028943211686@g.us` | WhatsApp group |
| Newsletter | `@newsletter` | `25220266111770696@newsletter` | WhatsApp newsletter/channel |
| Broadcast | `@broadcast` | `[id]@broadcast` | Broadcast list (deprecated) |

## Individual Phone Numbers

### Format Structure

**Individual JID format:**
```
[country_code][area_code][phone_number]@s.whatsapp.net
```

### Components Breakdown

1. **Country Code** (1-4 digits)
   - No `+` sign
   - No leading zeros
   - Examples: `1` (USA), `55` (Brazil), `91` (India), `971` (UAE)

2. **Area Code** (optional, varies by country)
   - Included as part of the phone number
   - No separators
   - Examples: `11` (São Paulo), `21` (Rio de Janeiro)

3. **Phone Number** (remaining digits)
   - Local phone number without formatting
   - No spaces, dashes, or parentheses
   - Length varies by country

4. **Suffix** (always `@s.whatsapp.net`)
   - `s` stands for "server"
   - Indicates this is an individual account

### Examples

**Brazil (+55):**
```
Phone: +55 11 99999-8888
JID:   5511999998888@s.whatsapp.net
       ││ │││││││││││
       ││ └────────── Phone number (9 digits)
       │└─ Area code (2 digits)
       └─ Country code (2 digits)
```

**USA (+1):**
```
Phone: +1 (415) 555-2671
JID:   14155552671@s.whatsapp.net
       │ │││ │││││││
       │ │││ └────── Phone number (7 digits)
       │ └────────── Area code (3 digits)
       └─ Country code (1 digit)
```

**India (+91):**
```
Phone: +91 98765 43210
JID:   919876543210@s.whatsapp.net
       ││ ││││││││││
       ││ └────────── Phone number (10 digits)
       │└─ No area code (India uses 10-digit format)
       └─ Country code (2 digits)
```

**UK (+44):**
```
Phone: +44 7911 123456
JID:   447911123456@s.whatsapp.net
       ││ ││││││││││
       ││ └────────── Phone number (10 digits with leading 7)
       │└─ No area code in mobile format
       └─ Country code (2 digits)
```

### When to Include JID Suffix

**Send operations** (sending messages, media, etc.):
```bash
# Most API endpoints automatically add @s.whatsapp.net
# You can use either format:

curl -X POST /send/message -d '{
  "phone": "5511999998888"
}'

# OR with full JID:
curl -X POST /send/message -d '{
  "phone": "5511999998888@s.whatsapp.net"
}'
```

**Validation/check operations** (checking if user exists):
```bash
# Use phone number WITHOUT suffix:
curl -X GET "/user/check?phone=5511999998888"
```

**Login operations** (pairing code):
```bash
# Use phone number WITHOUT suffix:
curl -X GET "/app/login-with-code?phone=5511999998888"
```

## Group Identifiers

### Format Structure

**Group JID format:**
```
[group_id]@g.us
```

### Components

1. **Group ID** (numeric)
   - Automatically generated by WhatsApp
   - Typically 17-20 digits
   - Cannot be manually created or predicted

2. **Suffix** (`@g.us`)
   - `g` stands for "group"
   - `us` is the server designation

### Examples

```
120363028943211686@g.us
│                │ │  │
│                │ │  └─ Server (always 'us')
│                │ └─ Group indicator
│                └─ @ separator
└─ Group ID (18 digits)
```

### Obtaining Group IDs

**Method 1: List your groups**
```bash
curl -X GET http://localhost:3000/user/my/groups

# Response includes group JIDs:
{
  "results": [
    {
      "jid": "120363028943211686@g.us",
      "name": "Family Group",
      "participants": 15
    }
  ]
}
```

**Method 2: From invite link**
```bash
curl -X GET "http://localhost:3000/group/info-from-link?link=https://chat.whatsapp.com/ABC123XYZ"

# Response includes group JID:
{
  "results": {
    "jid": "120363028943211686@g.us",
    "name": "Public Group"
  }
}
```

**Method 3: From webhook events**
```json
{
  "event": "message.received",
  "data": {
    "from": "120363028943211686@g.us",
    "is_group": true
  }
}
```

### Sending to Groups

```bash
curl -X POST http://localhost:3000/send/message \
  -H "Content-Type: application/json" \
  -d '{
    "phone": "120363028943211686@g.us",
    "message": "Hello group!"
  }'
```

## Newsletter Identifiers

### Format Structure

**Newsletter JID format:**
```
[newsletter_id]@newsletter
```

### Components

1. **Newsletter ID** (numeric)
   - Automatically generated by WhatsApp
   - Similar length to group IDs

2. **Suffix** (`@newsletter`)
   - Indicates WhatsApp newsletter/channel
   - Introduced with WhatsApp Channels feature

### Examples

```
25220266111770696@newsletter
│               │ │
│               │ └─ Newsletter indicator
│               └─ @ separator
└─ Newsletter ID (17 digits)
```

### Obtaining Newsletter IDs

**List your newsletters:**
```bash
curl -X GET http://localhost:3000/user/my/newsletters

# Response:
{
  "results": [
    {
      "jid": "25220266111770696@newsletter",
      "name": "Tech Updates",
      "description": "Latest technology news"
    }
  ]
}
```

### Newsletter Operations

**Unfollow newsletter:**
```bash
curl -X POST http://localhost:3000/newsletter/unfollow \
  -H "Content-Type: application/json" \
  -d '{
    "newsletter_id": "25220266111770696@newsletter"
  }'
```

## Format Examples by Country

### Americas

**Brazil (+55)**
```
City          | Phone            | JID
São Paulo     | +55 11 99999-8888| 5511999998888@s.whatsapp.net
Rio de Janeiro| +55 21 98888-7777| 5521988887777@s.whatsapp.net
Format: [55][area:2][number:9]
```

**USA/Canada (+1)**
```
State         | Phone            | JID
New York      | +1 (212) 555-0123| 12125550123@s.whatsapp.net
California    | +1 (415) 555-6789| 14155556789@s.whatsapp.net
Format: [1][area:3][number:7]
```

**Mexico (+52)**
```
City          | Phone            | JID
Mexico City   | +52 55 1234 5678 | 525512345678@s.whatsapp.net
Guadalajara   | +52 33 9876 5432 | 523398765432@s.whatsapp.net
Format: [52][area:2][number:8]
```

**Argentina (+54)**
```
City          | Phone            | JID
Buenos Aires  | +54 11 2345-6789 | 541123456789@s.whatsapp.net
Córdoba       | +54 351 234-5678 | 543512345678@s.whatsapp.net
Format: [54][area:2-3][number:6-8]
```

### Europe

**United Kingdom (+44)**
```
Type          | Phone            | JID
Mobile        | +44 7911 123456  | 447911123456@s.whatsapp.net
London        | +44 20 7123 4567 | 442071234567@s.whatsapp.net
Format: [44][area/mobile][number]
```

**Germany (+49)**
```
City          | Phone            | JID
Berlin        | +49 30 12345678  | 493012345678@s.whatsapp.net
Munich        | +49 89 87654321  | 498987654321@s.whatsapp.net
Format: [49][area:2-5][number:variable]
```

**France (+33)**
```
Type          | Phone            | JID
Mobile        | +33 6 12 34 56 78| 33612345678@s.whatsapp.net
Paris         | +33 1 42 12 34 56| 33142123456@s.whatsapp.net
Format: [33][area:1][number:8]
```

**Spain (+34)**
```
City          | Phone            | JID
Madrid        | +34 912 345 678  | 34912345678@s.whatsapp.net
Barcelona     | +34 932 123 456  | 34932123456@s.whatsapp.net
Format: [34][number:9]
```

### Asia

**India (+91)**
```
State         | Phone            | JID
Mumbai        | +91 98765 43210  | 919876543210@s.whatsapp.net
Delhi         | +91 98123 45678  | 919812345678@s.whatsapp.net
Format: [91][number:10]
```

**China (+86)**
```
City          | Phone            | JID
Beijing       | +86 138 0000 0000| 8613800000000@s.whatsapp.net
Shanghai      | +86 139 1234 5678| 8613912345678@s.whatsapp.net
Format: [86][number:11]
```

**Japan (+81)**
```
Type          | Phone            | JID
Mobile        | +81 90-1234-5678 | 819012345678@s.whatsapp.net
Tokyo         | +81 3-1234-5678  | 81312345678@s.whatsapp.net
Format: [81][area/mobile][number]
```

**Indonesia (+62)**
```
City          | Phone            | JID
Jakarta       | +62 812 3456 7890| 6281234567890@s.whatsapp.net
Surabaya      | +62 813 9876 5432| 6281398765432@s.whatsapp.net
Format: [62][area/mobile][number]
```

**Saudi Arabia (+966)**
```
Type          | Phone            | JID
Mobile        | +966 50 123 4567 | 966501234567@s.whatsapp.net
Riyadh        | +966 11 234 5678 | 966112345678@s.whatsapp.net
Format: [966][area/mobile][number]
```

### Africa

**South Africa (+27)**
```
City          | Phone            | JID
Johannesburg  | +27 82 123 4567  | 27821234567@s.whatsapp.net
Cape Town     | +27 83 987 6543  | 27839876543@s.whatsapp.net
Format: [27][area/mobile][number]
```

**Nigeria (+234)**
```
City          | Phone            | JID
Lagos         | +234 802 123 4567| 2348021234567@s.whatsapp.net
Abuja         | +234 803 987 6543| 2348039876543@s.whatsapp.net
Format: [234][area/mobile][number]
```

**Egypt (+20)**
```
City          | Phone            | JID
Cairo         | +20 10 1234 5678 | 201012345678@s.whatsapp.net
Alexandria    | +20 11 9876 5432 | 201198765432@s.whatsapp.net
Format: [20][area/mobile][number]
```

### Middle East

**United Arab Emirates (+971)**
```
City          | Phone            | JID
Dubai         | +971 50 123 4567 | 971501234567@s.whatsapp.net
Abu Dhabi     | +971 52 987 6543 | 971529876543@s.whatsapp.net
Format: [971][area/mobile][number]
```

**Turkey (+90)**
```
City          | Phone            | JID
Istanbul      | +90 532 123 4567 | 905321234567@s.whatsapp.net
Ankara        | +90 533 987 6543 | 905339876543@s.whatsapp.net
Format: [90][area/mobile][number]
```

## Common Mistakes

### Mistake 1: Including Plus Sign (+)

**❌ Wrong:**
```
+5511999998888@s.whatsapp.net
+5511999998888
```

**✅ Correct:**
```
5511999998888@s.whatsapp.net
5511999998888
```

**Why:** The `+` symbol is only used in international dialing notation. WhatsApp JIDs use raw numbers only.

### Mistake 2: Adding Formatting Characters

**❌ Wrong:**
```
+55 (11) 99999-8888
55-11-99999-8888
(55) 11 9.9999.8888
```

**✅ Correct:**
```
5511999998888
```

**Why:** JIDs must contain only digits - no spaces, dashes, parentheses, or periods.

### Mistake 3: Missing Country Code

**❌ Wrong:**
```
11999998888@s.whatsapp.net     (Brazil without country code)
4155552671@s.whatsapp.net      (USA without country code)
```

**✅ Correct:**
```
5511999998888@s.whatsapp.net   (Brazil with country code 55)
14155552671@s.whatsapp.net     (USA with country code 1)
```

**Why:** WhatsApp requires the full international format including country code.

### Mistake 4: Using Wrong Suffix

**❌ Wrong:**
```
5511999998888@g.us              (Individual with group suffix)
120363028943211686@s.whatsapp.net (Group with individual suffix)
```

**✅ Correct:**
```
5511999998888@s.whatsapp.net    (Individual)
120363028943211686@g.us         (Group)
```

**Why:** Each identifier type has its specific suffix.

### Mistake 5: Including Leading Zeros

**❌ Wrong:**
```
0055119999988 88@s.whatsapp.net  (Brazil with leading zeros)
0014155552671@s.whatsapp.net    (USA with leading zeros)
```

**✅ Correct:**
```
5511999998888@s.whatsapp.net
14155552671@s.whatsapp.net
```

**Why:** Country codes never have leading zeros in JID format.

### Mistake 6: Mixing Local and International Format

**❌ Wrong:**
```
# Using local format when international is required
11999998888@s.whatsapp.net      (Brazil local)
5552671@s.whatsapp.net          (USA local)
```

**✅ Correct:**
```
5511999998888@s.whatsapp.net    (Brazil international)
14155552671@s.whatsapp.net      (USA international)
```

**Why:** Always use complete international format with country code.

## Validation Rules

### Phone Number Validation

**Basic validation pattern:**
```
^[1-9]\d{10,14}$
```

**Rules:**
1. Must start with non-zero digit (country code)
2. Can contain 10-15 total digits
3. No special characters allowed
4. No spaces allowed

**Validation by component:**
```javascript
// JavaScript validation example
function validatePhoneNumber(phone) {
    // Remove any non-digit characters
    const cleaned = phone.replace(/\D/g, '');

    // Check total length (10-15 digits)
    if (cleaned.length < 10 || cleaned.length > 15) {
        return false;
    }

    // Check starts with non-zero (country code)
    if (cleaned[0] === '0') {
        return false;
    }

    return true;
}

// Examples
validatePhoneNumber('5511999998888');      // ✅ true
validatePhoneNumber('+55 11 99999-8888');  // ✅ true (gets cleaned)
validatePhoneNumber('011999998888');       // ❌ false (starts with 0)
validatePhoneNumber('123');                // ❌ false (too short)
```

### JID Validation

**Full JID validation pattern:**
```
Individual: ^[1-9]\d{10,14}@s\.whatsapp\.net$
Group:      ^\d{17,20}@g\.us$
Newsletter: ^\d{17,20}@newsletter$
```

**Validation function:**
```javascript
function validateJID(jid) {
    const patterns = {
        individual: /^[1-9]\d{10,14}@s\.whatsapp\.net$/,
        group: /^\d{17,20}@g\.us$/,
        newsletter: /^\d{17,20}@newsletter$/
    };

    return Object.values(patterns).some(pattern => pattern.test(jid));
}

// Examples
validateJID('5511999998888@s.whatsapp.net');    // ✅ true
validateJID('120363028943211686@g.us');         // ✅ true
validateJID('25220266111770696@newsletter');    // ✅ true
validateJID('invalid-format');                  // ❌ false
```

### Country-Specific Validation

**Brazil (+55):**
```javascript
function validateBrazilPhone(phone) {
    const cleaned = phone.replace(/\D/g, '');

    // Must start with 55 (country code)
    if (!cleaned.startsWith('55')) {
        return false;
    }

    // Total length: 12-13 digits (55 + 2 area + 8-9 number)
    if (cleaned.length < 12 || cleaned.length > 13) {
        return false;
    }

    return true;
}
```

**USA (+1):**
```javascript
function validateUSAPhone(phone) {
    const cleaned = phone.replace(/\D/g, '');

    // Must start with 1 (country code)
    if (!cleaned.startsWith('1')) {
        return false;
    }

    // Total length: 11 digits (1 + 3 area + 7 number)
    if (cleaned.length !== 11) {
        return false;
    }

    return true;
}
```

## API Usage

### Check if Number Exists

**Always validate before sending:**

```bash
curl -X GET "http://localhost:3000/user/check?phone=5511999998888"

# Response:
{
  "code": "SUCCESS",
  "results": {
    "exists": true,
    "jid": "5511999998888@s.whatsapp.net"
  }
}
```

### Send Message to Individual

```bash
# Method 1: Phone number only (recommended)
curl -X POST http://localhost:3000/send/message \
  -H "Content-Type: application/json" \
  -d '{
    "phone": "5511999998888",
    "message": "Hello!"
  }'

# Method 2: Full JID
curl -X POST http://localhost:3000/send/message \
  -H "Content-Type: application/json" \
  -d '{
    "phone": "5511999998888@s.whatsapp.net",
    "message": "Hello!"
  }'
```

### Send Message to Group

```bash
# Must use full JID for groups
curl -X POST http://localhost:3000/send/message \
  -H "Content-Type: application/json" \
  -d '{
    "phone": "120363028943211686@g.us",
    "message": "Hello group!"
  }'
```

### Get User Information

```bash
# Can use either format
curl -X GET "http://localhost:3000/user/info?phone=5511999998888"
# OR
curl -X GET "http://localhost:3000/user/info?phone=5511999998888@s.whatsapp.net"
```

### Conversion Helper Functions

**Convert phone to JID:**
```javascript
function phoneToJID(phone) {
    // Remove all non-digit characters
    const cleaned = phone.replace(/\D/g, '');

    // Add suffix
    return `${cleaned}@s.whatsapp.net`;
}

// Examples
phoneToJID('+55 11 99999-8888');  // 5511999998888@s.whatsapp.net
phoneToJID('5511999998888');      // 5511999998888@s.whatsapp.net
```

**Extract phone from JID:**
```javascript
function jidToPhone(jid) {
    // Extract phone part before @
    return jid.split('@')[0];
}

// Examples
jidToPhone('5511999998888@s.whatsapp.net');  // 5511999998888
jidToPhone('120363028943211686@g.us');       // 120363028943211686
```

**Format phone for display:**
```javascript
function formatPhone(phone, country = 'BR') {
    const cleaned = phone.replace(/\D/g, '');

    if (country === 'BR' && cleaned.startsWith('55')) {
        // Format: +55 (11) 99999-8888
        const cc = cleaned.substring(0, 2);
        const area = cleaned.substring(2, 4);
        const part1 = cleaned.substring(4, 9);
        const part2 = cleaned.substring(9);
        return `+${cc} (${area}) ${part1}-${part2}`;
    }

    if (country === 'US' && cleaned.startsWith('1')) {
        // Format: +1 (415) 555-2671
        const cc = cleaned.substring(0, 1);
        const area = cleaned.substring(1, 4);
        const part1 = cleaned.substring(4, 7);
        const part2 = cleaned.substring(7);
        return `+${cc} (${area}) ${part1}-${part2}`;
    }

    // Default format: +CC number
    return `+${cleaned}`;
}
```

## Troubleshooting

### Error: Invalid JID Format

**Problem:** API returns "Invalid JID" error

**Possible Causes:**
1. Missing country code
2. Contains formatting characters
3. Wrong suffix
4. Leading zeros

**Solution:**
```bash
# Check the phone number format
echo "5511999998888" | grep -E "^[1-9][0-9]{10,14}$"

# If match, format is correct
# If no match, review the number
```

### Error: User Not Found

**Problem:** API returns "User is not on WhatsApp"

**Possible Causes:**
1. Number doesn't have WhatsApp
2. Wrong country code
3. Missing or extra digits

**Solution:**
```bash
# Verify number exists
curl -X GET "http://localhost:3000/user/check?phone=5511999998888"

# Try with country code variations
curl -X GET "http://localhost:3000/user/check?phone=5511999998888"  # With 9
curl -X GET "http://localhost:3000/user/check?phone=551199998888"   # Without 9
```

### Error: Message Not Delivered

**Problem:** Message send succeeds but not delivered

**Possible Causes:**
1. Recipient blocked you
2. Recipient's phone is off
3. Network issues
4. Rate limiting

**Solution:**
1. Check message status via webhook
2. Verify recipient can receive from others
3. Check application logs for errors
4. Wait and retry after some time

### Validation Before Sending

**Always validate before attempting to send:**

```bash
#!/bin/bash
# validate-and-send.sh

PHONE="$1"
MESSAGE="$2"

# Remove non-digits
CLEAN_PHONE=$(echo "$PHONE" | tr -cd '0-9')

# Validate length
if [ ${#CLEAN_PHONE} -lt 10 ] || [ ${#CLEAN_PHONE} -gt 15 ]; then
    echo "Error: Phone number must be 10-15 digits"
    exit 1
fi

# Validate starts with non-zero
if [[ "$CLEAN_PHONE" =~ ^0 ]]; then
    echo "Error: Phone number cannot start with 0"
    exit 1
fi

# Check if user exists
EXISTS=$(curl -s "http://localhost:3000/user/check?phone=$CLEAN_PHONE" | \
  jq -r '.results.exists')

if [ "$EXISTS" != "true" ]; then
    echo "Error: Number not on WhatsApp"
    exit 1
fi

# Send message
curl -X POST http://localhost:3000/send/message \
  -H "Content-Type: application/json" \
  -d "{\"phone\": \"$CLEAN_PHONE\", \"message\": \"$MESSAGE\"}"
```

### Debugging Tips

**Enable debug mode:**
```bash
./whatsapp rest --debug=true
```

**Check logs for JID errors:**
```bash
# Look for JID-related errors
grep -i "invalid.*jid" /var/log/whatsapp/app.log
grep -i "jid.*error" /var/log/whatsapp/app.log
```

**Test JID format:**
```bash
# Valid individual JID
curl -X POST .../send/message -d '{"phone":"5511999998888@s.whatsapp.net"}'

# Valid without suffix (auto-added)
curl -X POST .../send/message -d '{"phone":"5511999998888"}'

# Valid group JID
curl -X POST .../send/message -d '{"phone":"120363028943211686@g.us"}'
```

## Quick Reference

### Phone Number Checklist

When formatting phone numbers, ensure:

- [ ] Remove all formatting characters (spaces, dashes, parentheses)
- [ ] Remove `+` sign
- [ ] Include country code
- [ ] No leading zeros
- [ ] 10-15 digits total
- [ ] Starts with non-zero digit

### JID Format Quick Guide

```
Individual: [country][area][number]@s.whatsapp.net
Group:      [group_id]@g.us
Newsletter: [newsletter_id]@newsletter

Example Individual: 5511999998888@s.whatsapp.net
Example Group:      120363028943211686@g.us
Example Newsletter: 25220266111770696@newsletter
```

### Common Country Codes

| Country | Code | Example |
|---------|------|---------|
| USA/Canada | 1 | 14155552671 |
| Brazil | 55 | 5511999998888 |
| UK | 44 | 447911123456 |
| India | 91 | 919876543210 |
| Germany | 49 | 493012345678 |
| France | 33 | 33612345678 |
| Spain | 34 | 34912345678 |
| Mexico | 52 | 525512345678 |
| Argentina | 54 | 541123456789 |
| South Africa | 27 | 27821234567 |

## Related Documentation

- **[First Message Guide](../getting-started/first-message.md)** - Send your first message
- **[API Documentation](../reference/api/openapi.md)** - Complete API reference
- **[Troubleshooting Guide](troubleshooting.md)** - Common issues and solutions
- **[Configuration Reference](configuration.md)** - Account validation settings

---

**Version**: Compatible with v7.10.1+
**Last Updated**: 2025-12-05
